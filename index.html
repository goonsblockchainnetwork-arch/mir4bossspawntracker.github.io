<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIR4 Boss Spawn Tracker</title>
    <style>
        :root {
            --bg: #ffffff;
            --text: #000000;
            --card: #f0f0f0;
            --border: #ddd;
        }
        [data-theme="dark"] {
            --bg: #121212;
            --text: #ffffff;
            --card: #1e1e1e;
            --border: #333;
        }
        body {
            display: flex;
            font-family: Arial, sans-serif;
            margin: 0;
            background: var(--bg);
            color: var(--text);
            transition: background 0.3s, color 0.3s;
        }
        nav {
            width: 200px;
            background-color: var(--card);
            padding: 10px;
            height: 100%vh;
            overflow-y: auto;
            border-right: 1px solid var(--border);
        }
        nav ul {
            list-style: none;
            padding: 0;
        }
        nav li {
            cursor: pointer;
            padding: 10px;
            margin-bottom: 5px;
            background-color: var(--border);
            border-radius: 1px solid var(--border);
            border-radius: 5px;
        }
        nav li:hover, nav li.active {
            background-color: var(--text);
            color: var(--bg);
        }
        main {
            flex: 1;
            padding: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid var(--border);
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: var(--card);
        }

        /* Floating Dark Mode Button */
        #theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--text);
            color: var(--bg);
            border: none;
            border-radius: 50%;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
        }

        /* Centered Upcoming Bosses Modal */
        #upcomingModal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        .modal-content {
            background: var(--card);
            padding: 20px;
            border-radius: 12px;
            max-width: 720px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 1px solid var(--border);
        }
        .time-left { font-size: 1.4em; font-weight: bold; color: #ffeb3b; margin-top: 6px; }
        .close-btn {
            margin-top: 15px 10 5px;
            padding: 8px 20px;
            background: transparent;
            border: 1px solid var(--text);
            color: var(--text);
            border-radius: 6px;
            cursor: pointer;
        }
        .auto-close { font-size: 0.9em; color: #aaa; }
    </style>
</head>
<body>
    <h1>GOONS</h1>
    <nav>
        <ul id="map-list"></ul>
    </nav>

    <main>
        <h1>MIR4 Boss Spawn Tracker</h1>
        <p>Note: Timers are based on your local time. Adjust for your server's timezone (e.g., MIR4 often uses UTC+8 for Asia servers).</p>
        <table id="boss-table">
            <thead>
                <tr>
                    <th>Boss Name</th>
                    <th>Location/Map</th>
                    <th>Next Spawn</th>
                    <th>Countdown</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </main>

    <!-- Floating Dark Mode Toggle -->
    <button id="theme-toggle" onclick="toggleTheme()">Dark</button>

    <!-- Simple Table Modal -->
    <div id="upcomingModal">
        <div class="modal-content">
            <h2>Next Bosses Spawning Soon</h2>
            <table class="modal-table">
                <thead>
                    <tr>
                        <th>Boss</th>
                        <th>Location</th>
                        <th>Time Left</th>
                    </tr>
                </thead>
                <tbody id="modal-boss-list"></tbody>
            </table>
            <p></p>
            <br>
            <button class="close-btn" onclick="closeModal()">Close</button>
            <p></p>
            <div class="auto-close">Auto-close in <span id="autoCloseTimer">10</span>s</div>
        </div>
    </div>

    <script>
        // Boss data array - easy to add more bosses here
        // For daily: provide array of times in "HH:MM" format
        // For weekly: provide day (0=Sunday, 1=Monday, ..., 6=Saturday) and time "HH:MM"
        // For respawn (hourly/after kill): provide interval in milliseconds (e.g., 30 min = 30 * 60 * 1000)
        // Add more types as needed by extending the getNextSpawn function
        const bosses = [
        // Cryptic Sanctuary
            { name: "Brawler Chubbee", location: "Cryptic Sanctuary", map: "Cryptic Sanctuary", type: "daily", times: ["03:00", "06:00", "09:00", "12:00", "15:00", "18:00", "21:00", "24:00"] },
            { name: "Madened Irua", location: "Cryptic Sanctuary", map: "Cryptic Sanctuary", type: "daily", times: ["03:00", "01:00", "04:00", "07:00", "10:00", "13:00", "16:00", "19:00", "22:00"] },
            { name: "Demon Emperor Reaper", location: "Cryptic Sanctuary", map: "Cryptic Sanctuary", type: "daily", times: ["02:00", "05:00", "08:00", "11:00", "14:00", "17:00", "20:00", "23:00"] },
        // W1
            { name: "Mata", location: "Bullface Forest", map: "World 1", type: "daily", times: ["02:00", "04:00", "06:00", "08:00", "10:00", "12:00", "14:00", "16:00", "18:00", "20:00", "22:00", "24:00"] },
            { name: "Boltox", location: "Demon Bull Temple 1F", map: "World 1", type: "daily", times: ["01:00", "03:00", "05:00", "07:00", "09:00", "11:00", "13:00", "15:00", "17:00", "19:00", "21:00", "23:00"] },
            { name: "Bullface Fiend King", location: "Bullface Fiend King's Sanctuary", map: "World 1", type: "daily", times: ["03:00", "06:00", "09:00", "12:00", "15:00", "18:00", "21:00", "24:00"] },
            // W8
            { name: "Yeo Wihuang", location: "Whitemaur Sealing Circle", map: "World 8", type: "daily", times: ["03:00", "06:00", "09:00", "12:00", "15:00", "18:00", "21:00", "24:00"] },
            // W7
            { name: "Taehyul", location: "Taehyul;s Garden", map: "World 7", type: "daily", times: ["01:00", "03:00", "05:00", "07:00", "09:00", "11:00", "13:00", "15:00", "17:00", "19:00", "21:00", "23:00"] },
            { name: "Yiun", location: "Demonic Cult Main Hall", map: "World 7", type: "daily", times: ["02:00", "05:00", "08:00", "11:00", "14:00", "17:00", "20:00", "23:00"] },
            // W4
            { name: "Nefariox Obdurate Zenith", location: "Phantasia Desert", map: "World 4", type: "daily", times: ["02:00", "04:00", "06:00", "08:00", "10:00", "12:00", "14:00", "16:00", "18:00", "20:00", "22:00", "24:00"] },
            { name: "Kurilaica", location: "Overlord Sealing Circle", map: "World 4", type: "daily", times: ["03:00", "06:00", "09:00", "12:00", "15:00", "18:00", "21:00", "24:00"] },
            // W2
            { name: "Juhui", location: "Redmoon Mountain", map: "World 2", type: "daily", times: ["02:30", "05:30", "08:30", "11:30", "14:30", "17:30", "20:30", "23:30"] },
            // W5
            { name: "Faluk", location: "Great Sabuk Wall Camp", map: "World 5", type: "daily", times: ["03:30", "06:30", "09:30", "12:30", "15:30", "18:30", "21:30", "24:30"] },
            { name: "Tale Warper Fiend", location: "Illusion Temple", map: "World 5", type: "daily", times: ["01:30", "04:30", "07:30", "10:30", "13:30", "16:30", "19:30", "22:30"] },
            // W3
            { name: "Dusk Armado Emperor", location: "Viperbeast Plain", map: "World 3", type: "daily", times: ["01:30", "03:30", "05:30", "07:30", "09:30", "11:30", "13:30", "15:30", "17:30", "19:30", "21:30", "23:30"] },
            { name: "Mara", location: "Rockut Tomb", map: "World 3", type: "daily", times: ["02:30", "05:30", "08:30", "11:30", "14:30", "17:30", "20:30", "23:30"] },
            { name: "Tombbeast Gyo", location: "Nefariox Necropolis", map: "World 3", type: "daily", times: ["02:30", "08:30", "14:30", "20:30"] },
            { name: "Boodo", location: "Rockut Tomb", map: "World 3", type: "daily", times: ["03:30", "09:30", "15:30", "21:30"] },
            // W6
            { name: "Cheol Mokgang", location: "Bicheon Town", map: "World 6", type: "daily", times: ["02:30", "04:30", "06:30", "08:30", "10:30", "12:30", "14:30", "16:30", "18:30", "20:30", "22:30", "24:30"] },
            { name: "Hong Yeo", location: "Demoniac Mine", map: "World 6", type: "daily", times: ["01:30", "03:30", "05:30", "07:30", "09:30", "11:30", "13:30", "15:30", "17:30", "19:30", "21:30", "23:30"] },
            { name: "Bicheon Sura", location: "Bicheon Town", map: "World 6", type: "daily", times: ["04:30", "10:30", "16:30", "22:30"] },
            { name: "Wuihan", location: "Phantom Woods", map: "World 6", type: "daily", times: ["05:30", "11:30", "17:30", "23:30"] },
            { name: "Obscene Yeticlops", location: "Bicheon Labyrinth", map: "World 6", type: "daily", times: ["06:30", "12:30", "18:30", "24:30"] },
        // SPECIAL BOSS
            { name: "Demon Spider of Hell Krukan", location: "Shackling Abaddon", map: "Special Boss", type: "weekly", day: 1, time: "23:00" }, // Monday
            { name: "Black Flame Arch Demon Nerkan", location: "Black Flame Abaddon", map: "Special Boss", type: "weekly", day: 2, time: "23:00" }, // Tuesday
            { name: "Hellish Lord Helbar", location: "Redmoon Purgatory 7F", map: "Redmoon Purgatory", type: "weekly", day: 3, time: "23:00" }, // Monday
            { name: "Violet Demon God Turkan", location: "Violet Abaddon", map: "Special Boss", type: "weekly", day: 4, time: "23:00" }, // Thursday
            { name: "Crimson Emperor Utukan", location: "Crimson Abaddon", map: "Special Boss", type: "weekly", day: 5, time: "23:00" }, // Friday
            
            // name: "Leader's Chamber I", map: "Magic Square", type: "respawn", interval: 30 * 60 * 1000 }, // 30 min
            // name: "Leader's Chamber II", map: "Magic Square", type: "respawn", interval: 45 * 60 * 1000 }, // 45 min
            // name: "Leader's Chamber III", map: "Magic Square", type: "daily", times: ["03:00", "06:00", "09:00", "12:00", "15:00", "18:00", "21:00", "00:00"] },
            // name: "Lower Left Boss", map: "Secret Peak", type: "daily", times: ["13:00", "19:00", "01:00", "07:00"] },
            // name: "Upper Right Boss", map: "Secret Peak", type: "daily", times: ["16:00", "22:00", "04:00", "10:00"] },
            // name: "Green Boss", map: "Secret Peak", type: "respawn", interval: 30 * 60 * 1000 }, // Example hourly respawn
            // name: "Yellow Boss", map: "Secret Peak", type: "respawn", interval: 60 * 60 * 1000 }, // Example hourly
        ];

        const maps = [...new Set(bosses.map(b => b.map))];
        const modal = document.getElementById('upcomingModal');

        // Theme toggle
        const themeBtn = document.getElementById('theme-toggle');
        function toggleTheme() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            document.documentElement.setAttribute('data-theme', isDark ? '' : 'dark');
            themeBtn.textContent = isDark ? 'Dark' : 'Light';
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
        }
        if (localStorage.getItem('theme') === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            themeBtn.textContent = 'Light';
        }

        // Navigation
        const ul = document.getElementById('map-list');
        const allLi = document.createElement('li');
        allLi.textContent = 'All Maps'; allLi.classList.add('active');
        allLi.onclick = () => { setActive(allLi); filterTable(null); };
        ul.appendChild(allLi);
        maps.forEach(m => {
            const li = document.createElement('li');
            li.textContent = m;
            li.onclick = () => { setActive(li); filterTable(m); };
            ul.appendChild(li);
        });
        function setActive(el) {
            document.querySelectorAll('nav li').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
        }

        // Next spawn calculation
        function getNextSpawn(boss) {
            const now = new Date();
            if (boss.type === 'daily') {
                let next = null;
                boss.times.forEach(t => {
                    const [h, m] = t.split(':').map(Number);
                    let d = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0);
                    if (d < now) d.setDate(d.getDate() + 1);
                    if (!next || d < next) next = d;
                });
                return next;
            } else if (boss.type === 'weekly') {
                let d = new Date(now);
                const [h, m] = boss.time.split(':').map(Number);
                d.setHours(h, m, 0, 0);
                let diff = boss.day - d.getDay();
                if (diff < 0 || (diff === 0 && d < now)) diff += 7;
                d.setDate(d.getDate() + diff);
                return d;
            }
            return null;
        }

        function getUpcoming(limit = 10) {
            const list = bosses
                .map(b => ({ b, next: getNextSpawn(b) }))
                .filter(o => o.next)
                .map(o => ({ ...o, diff: o.next - new Date() }))
                .filter(o => o.diff > 0)
                .sort((a,b) => a.diff - b.diff)
                .slice(0, limit);
            return list;
        }

        function showModal() {
            const container = document.getElementById('modal-boss-list');
            container.innerHTML = '';
            const upcoming = getUpcoming(10);
            upcoming.forEach(u => {
                const h = Math.floor(u.diff / 3600000);
                const m = Math.floor((u.diff % 3600000) / 60000);
                container.innerHTML += `
                    <tr>
                        <th>${u.b.name}</th>
                        <th>${u.b.location}</th>
                        <th>${h}h ${m}m</th>
                    </tr>`;
            });
            modal.style.display = 'flex';

            let secs = 30;
            document.getElementById('autoCloseTimer').textContent = secs;
            clearInterval(window.autoCloseInt);
            window.autoCloseInt = setInterval(() => {
                if (--secs <= 0) closeModal();
                document.getElementById('autoCloseTimer').textContent = secs;
            }, 1000);
        }
        function closeModal() {
            modal.style.display = 'none';
            clearInterval(window.autoCloseInt);
        }

        // Table functions (unchanged)
        function populateTable(filtered) {
            const tbody = document.querySelector('#boss-table tbody');
            tbody.innerHTML = '';
            filtered.forEach(b => {
                const tr = document.createElement('tr');
                const id = b.name.replace(/\s/g,'');
                tr.innerHTML = `
                    <td>${b.name}</td>
                    <td>${b.location}</td>
                    <td id="next-${id}"></td>
                    <td id="count-${id}"></td>`;
                tbody.appendChild(tr);
            });
        }
        function updateTimers() {
            bosses.forEach(b => {
                const nextEl = document.getElementById(`next-${b.name.replace(/\s/g,'')}`);
                const countEl = document.getElementById(`count-${b.name.replace(/\s/g,'')}`);
                if (!nextEl) return;
                const next = getNextSpawn(b);
                if (next) {
                    nextEl.textContent = next.toLocaleString();
                    const diff = next - new Date();
                    if (diff > 0) {
                        const h = Math.floor(diff / 3600000);
                        const m = Math.floor((diff % 3600000) / 60000);
                        const s = Math.floor((diff % 60000) / 1000);
                        countEl.textContent = `${h}h ${m}m ${s}s`;
                        countEl.style.color = diff < 600000 ? '#00ff00' : '';
                    } else {
                        countEl.textContent = 'Spawned';
                        countEl.style.color = '#00ff00';
                    }
                }
            });
        }
        function filterTable(map) {
            const filtered = map ? bosses.filter(b => b.map === map) : bosses;
            populateTable(filtered);
            updateTimers();
        }

        // Init
        filterTable(null);
        setInterval(updateTimers, 1000);
        setTimeout(() => {
            updateTimers();
            setTimeout(showModal, 600);
        }, 200);
    </script>
</body>
</html>
